<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_downloads_front_browse extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = '';\n\tfunction categories(  ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsPageHeader ipsPad_half ipsClearfix ipsSpacer_bottom\" id='elDownloadersHeader' data-ipsSticky data-ipsSticky-disableIn='phone'>\n\t\t<h1 class=\"ipsType_pageTitle\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( '__app_downloads', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;&nbsp;<a href='#elDownloadsCategories_menu' data-ipsMenu data-ipsMenu-appendTo='#elDownloadersHeader' id='elDownloadsCategories' class='ipsButton ipsButton_light ipsButton_small'><span class='ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'downloads_category_select', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n&nbsp;&nbsp;<\/span> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'all', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a><\/h1>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryMenu( \\IPS\\downloads\\Category::roots() );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class='ipsBox'>\n\t\t<h2 class='ipsType_sectionTitle ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'categories', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<ol class=\"ipsDataList ipsDataList_large\">\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryRow( NULL, NULL, \\IPS\\downloads\\Category::roots() );\n$return .= <<<CONTENT\n\n\t\t<\/ol>\n\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\n\t\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction categoriesSidebar( $currentCategory=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !$currentCategory or !$currentCategory->club() ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$categories = $currentCategory ? $currentCategory->children() : \\IPS\\downloads\\Category::roots();\n$return .= <<<CONTENT\n\n\n\t\nCONTENT;\n\nif ( !\\IPS\\downloads\\Category::theOnlyNode() ):\n$return .= <<<CONTENT\n\n\t<div id='elDownloadsCategoriesBlock' class='ipsWidget ipsWidget_vertical ipsBox'>\n\t\t<h3 class='ipsType_sectionTitle ipsType_reset'>\nCONTENT;\n\nif ( $currentCategory ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'subcategories', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'categories', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/h3>\n\t\t<div class='ipsPad_half'>\n\t\t\t<div class='ipsSideMenu'>\n\t\t\t\t<ul class='ipsSideMenu_list'>\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $categories as $category ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $category->open OR \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $category->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='ipsSideMenu_item ipsTruncate ipsTruncate_line'><span class='ipsBadge ipsBadge_style1 ipsPos_right cDownloadsCategoryCount'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( \\IPS\\downloads\\File::contentCount( $category ) );\n$return .= <<<CONTENT\n<\/span><strong class='ipsType_normal'>\nCONTENT;\n$return .= htmlspecialchars( $category->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong><\/a>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $category->hasChildren() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<ul class=\"ipsSideMenu_list\">\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $category->children() as $idx => $subcategory ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $subcategory->open OR \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $idx >= 5 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $category->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsSideMenu_item'><span class='ipsType_light ipsType_small'>\nCONTENT;\n\n$pluralize = array( count( $category->children() ) - 5 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'and_x_more', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span><\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nbreak;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $subcategory->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='ipsSideMenu_item ipsTruncate ipsTruncate_line'><strong class='ipsPos_right ipsType_small cDownloadsCategoryCount'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( \\IPS\\downloads\\File::contentCount( $subcategory ) );\n$return .= <<<CONTENT\n<\/strong>\nCONTENT;\n$return .= htmlspecialchars( $subcategory->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\t<p class='ipsType_center'>\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=downloads&module=downloads&controller=browse&do=categories\", null, \"downloads_categories\", array(), 0 ) );\n$return .= <<<CONTENT\n' class=''>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'browse_categories_d', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-right'><\/i><\/a>\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction category( $category, $table ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $club = $category->club() ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->clubs and \\IPS\\Settings::i()->clubs_header == 'full' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"clubs\", \"core\" )->header( $club, $category );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div id='elClubContainer'>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class=\"ipsPageHeader ipsClearfix ipsSpacer_bottom\">\n\t<h1 class=\"ipsType_pageTitle\">\nCONTENT;\n$return .= htmlspecialchars( $category->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h1>\n\t<div class='ipsPos_right ipsResponsive_noFloat ipsResponsive_hidePhone'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->follow( 'downloads', 'category', $category->_id, \\IPS\\downloads\\File::containerFollowers( $category )->count( TRUE ) );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nif ( $category->hasChildren() ):\n$return .= <<<CONTENT\n\n\t\t<br>\n\t\t<a href='#elDownloadsCategories_menu' data-ipsMenu id='elDownloadsCategories' class='ipsButton ipsButton_fullWidth ipsButton_light ipsButton_small ipsResponsive_block ipsResponsive_hideDesktop'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'subcategory', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $category->description ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsPageHeader_info ipsType_normal'>\n\t\t\t{$category->description}\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryMenu( $category->children() );\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\downloads\\Category::canOnAny('add') AND ( !$category OR $category->can('add') )  ):\n$return .= <<<CONTENT\n\n<ul class=\"ipsToolList ipsToolList_horizontal ipsResponsive_hidePhone ipsClearfix ipsSpacer_both\">\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryButtons( \\IPS\\downloads\\Category::canOnAny('add'), $category );\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class='ipsBox cDownloadsCategoryTable'>\n{$table}\n<\/div>\n\n\nCONTENT;\n\nif ( \\IPS\\downloads\\Category::canOnAny('add') AND ( !$category OR $category->can('add') )  ):\n$return .= <<<CONTENT\n\n<ul class=\"ipsToolList ipsToolList_horizontal ipsResponsive_showPhone ipsResponsive_block ipsClearfix ipsSpacer_top\">\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryButtons( \\IPS\\downloads\\Category::canOnAny('add'), $category );\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class='ipsResponsive_showPhone ipsResponsive_block ipsSpacer_top'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->follow( 'downloads', 'category', $category->_id, \\IPS\\downloads\\File::containerFollowers( $category )->count( TRUE ) );\n$return .= <<<CONTENT\n\n<\/div>\n\n\nCONTENT;\n\nif ( $category->club() ):\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction categoryButtons( $canSubmitFiles, $currentCategory=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $canSubmitFiles AND ( !$currentCategory OR $currentCategory->can('add') )  ):\n$return .= <<<CONTENT\n\n<li class='ipsToolList_primaryAction'>\n\t\nCONTENT;\n\nif ( $currentCategory ):\n$return .= <<<CONTENT\n\n\t\t<a class=\"ipsButton ipsButton_medium ipsButton_important ipsButton_fullWidth\" href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=downloads&module=downloads&controller=submit&category={$currentCategory->id}&do=submit\", null, \"downloads_submit\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<a class=\"ipsButton ipsButton_medium ipsButton_important ipsButton_fullWidth\" href=\"\nCONTENT;\n\nif ( $currentCategory ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=downloads&module=downloads&controller=submit&category={$currentCategory->id}&_new=1\", null, \"downloads_submit\", array(), 0 ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=downloads&module=downloads&controller=submit&_new=1\", null, \"downloads_submit\", array(), 0 ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit_a_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-size='narrow'>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit_a_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n<\/li>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction categoryMenu( $categories ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<ul class='ipsMenu ipsMenu_auto ipsHide' id='elDownloadsCategories_menu'>\n\t\nCONTENT;\n\nforeach ( $categories as $cat ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $cat->can('view') ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsMenu_item'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $cat->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><span class=\"ipsMenu_itemCount\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( \\IPS\\downloads\\File::contentCount( $cat ) );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n$return .= htmlspecialchars( $cat->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction categoryRow( $table, $headers, $categories ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $categories as $category ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $category->can('view') AND ( $category->open OR \\IPS\\Member::loggedIn()->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t<li class=\"ipsDataItem ipsDataItem_responsivePhoto ipsClearfix\">\n\t\t\t<div class='ipsDataItem_icon'>\n\t\t\t\t<span class='ipsItemStatus ipsItemStatus_large \nCONTENT;\n\nif ( !\\IPS\\downloads\\File::containerUnread( $category ) ):\n$return .= <<<CONTENT\nipsItemStatus_read\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<i class=\"fa fa-download\"><\/i>\n\t\t\t\t<\/span>\n\t\t\t<\/div>\n\t\t\t<div class=\"ipsDataItem_main ipsPos_middle\">\n\t\t\t\t<h4 class=\"ipsDataItem_title ipsType_large\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $category->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $category->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/h4>\n\t\t\t\t\nCONTENT;\n\nif ( $category->hasChildren() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<ul class=\"ipsDataItem_subList ipsList_inline\">\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $category->children() as $subcategory ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"\nCONTENT;\n\nif ( \\IPS\\downloads\\File::containerUnread( $subcategory ) ):\n$return .= <<<CONTENT\nipsDataItem_unread\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $subcategory->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $subcategory->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $category->description ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsDataItem_meta\">{$category->description}<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<dl class=\"ipsDataItem_stats ipsDataItem_statsLarge\">\n\t\t\t\t\nCONTENT;\n\n$count = \\IPS\\downloads\\File::contentCount( $category );\n$return .= <<<CONTENT\n\n\t\t\t\t<dt class=\"ipsDataItem_stats_number\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $count );\n$return .= <<<CONTENT\n<\/dt>\n\t\t\t\t<dd class=\"ipsDataItem_stats_type ipsType_light\">\nCONTENT;\n\n$pluralize = array( $count ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'files_no_number', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/dd>\n\t\t\t<\/dl>\n\t\t\t<ul class=\"ipsDataItem_lastPoster ipsDataItem_withPhoto\">\n\t\t\t\t\nCONTENT;\n\nif ( $lastPost = $category->lastFile() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $lastPost->author(), 'tiny' );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $lastPost->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='ipsType_break ipsContained'>\nCONTENT;\n$return .= htmlspecialchars( $lastPost->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t<li class='ipsType_blendLinks'>\nCONTENT;\n\n$htmlsprintf = array($lastPost->author()->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_nodate', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t<li data-short=\"1 dy\" class=\"ipsType_light\">\nCONTENT;\n\n$val = ( $lastPost->submitted instanceof \\IPS\\DateTime ) ? $lastPost->submitted : \\IPS\\DateTime::ts( $lastPost->submitted );$return .= $val->html();\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t\nCONTENT;\n\nif ( method_exists( $table, 'canModerate' ) AND $table->canModerate() ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsDataItem_modCheck'>\n\t\t\t\t<span class='ipsCustomInput'>\n\t\t\t\t\t<input type='checkbox' data-role='moderation' name=\"moderate[\nCONTENT;\n$return .= htmlspecialchars( $category->_id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" data-actions=\"\nCONTENT;\n\n$return .= htmlspecialchars( implode( ' ', $table->multimodActions( $category ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-state=''>\n\t\t\t\t\t<span><\/span>\n\t\t\t\t<\/span>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction featuredFile( $file ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<li class='ipsCarousel_item ipsAreaBackground_reset ipsPad'>\n\t<div class='ipsColumns ipsColumns_collapsePhone'>\n\t\t<div class='ipsColumn ipsColumn_medium ipsType_center'>\n\t\t\t\nCONTENT;\n\nif ( $file->primary_screenshot ):\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->thumbImage( $file->primary_screenshot_thumb, $file->name, 'large', '', 'view_this', $file->url() );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsPos_left ipsNoThumb ipsThumb ipsThumb_large'><\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div class='ipsColumn ipsColumn_fluid'>\n\t\t\t<h2 class='ipsType_pageTitle ipsContained_container'>\n\t\t\t\t\nCONTENT;\n\nif ( $file->prefix() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=search&controller=search&tags={$file->prefix( TRUE )}\", null, \"tags\", array(), 0 ) );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($file->prefix()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'find_tagged_content', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" class='ipsTag_prefix'>\nCONTENT;\n$return .= htmlspecialchars( $file->prefix(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsType_break ipsContained'><a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $file->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/span>\n\t\t\t\t\nCONTENT;\n\nif ( $file->mapped('pinned') || $file->hidden() === -1 || $file->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span>\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->hidden() === -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n$return .= htmlspecialchars( $file->hiddenBlurb(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span>\n\t\t\t\t\t\nCONTENT;\n\nelseif ( $file->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pending_approval', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-warning'><\/i><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->mapped('pinned') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pinned', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-thumb-tack'><\/i><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsType_large ipsType_light ipsType_unbold ipsType_noBreak'>\nCONTENT;\n\n$htmlsprintf = array($file->author()->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_nodate', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/h2>\n\t\t\t<ul class='ipsList_inline ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t\nCONTENT;\n\nif ( $price = $file->price() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span class='cFilePrice ipsType_large'>{$price}<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $file->container()->bitoptions['reviews'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->rating( 'large', $file->rating, \\IPS\\Settings::i()->reviews_rating_out_of );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class='ipsType_normal'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->reviews ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url()->setQueryString( 'tab', 'reviews' )->setFragment('replies'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$pluralize = array( $file->reviews ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'num_reviews', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->reviews ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $file->isPaid() and in_array( 'purchases', explode( ',', \\IPS\\Settings::i()->idm_nexus_display ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsType_normal'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $purchases = $file->purchaseCount() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<i class='fa fa-shopping-cart'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $purchases, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class='ipsType_light'><i class='fa fa-shopping-cart'><\/i> 0<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\t\t\t\nCONTENT;\n\nif ( !$file->isPaid() or in_array( 'downloads', explode( ',', \\IPS\\Settings::i()->idm_nexus_display ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsType_normal'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->downloads ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<i class='fa fa-arrow-circle-down'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $file->downloads, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class='ipsType_light'><i class='fa fa-arrow-circle-down'><\/i> 0<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\n\t\t\t\t\nCONTENT;\n\nif ( $file->container()->bitoptions['comments'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsType_normal'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->comments ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<i class='fa fa-comment'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $file->comments, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class='ipsType_light'><i class='fa fa-comment'><\/i> 0<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t\t\n\t\t\t<div class='ipsType_richText ipsType_normal ipsSpacer_both' data-ipsTruncate data-ipsTruncate-type=\"remove\" data-ipsTruncate-size=\"2 lines\">\n\t\t\t\t{$file->truncated(TRUE)}\n\t\t\t<\/div>\n\n\t\t\t<ul class='ipsToolList ipsToolList_horizontal'>\n\t\t\t\t\nCONTENT;\n\nif ( ( $file->canDownload() or ( $file->container()->message('npd') and !$file->canBuy() ) ) && !$file->canBuy() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsToolList_primaryAction ipsPos_left'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n\nif ( \\IPS\\Settings::i()->idm_antileech ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $file->url('download')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $file->url('download'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_important ipsButton_fullWidth ipsButton_small' \nCONTENT;\n\nif ( $file->container()->message('disclaimer') or count( $file->files() ) > 1 or \\IPS\\Member::loggedIn()->group['idm_wait_period'] ):\n$return .= <<<CONTENT\ndata-ipsDialog\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'download', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nelseif ( $file->canBuy() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsToolList_primaryAction ipsPos_left'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url('buy')->csrf(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_small ipsButton_fullWidth ipsButton_important'><i class='fa fa-shopping-cart'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'buy_now', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $price ):\n$return .= <<<CONTENT\n - \nCONTENT;\n\n$return .= htmlspecialchars( strip_tags($price), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsPos_left'>\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_fullWidth ipsButton_small' title='\nCONTENT;\n\n$sprintf = array($file->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_this_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more_information', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\t\t\t\t\t\t\t\t\n\t\t<\/div>\n\t<\/div>\n<\/li>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction index( $featured, $new, $rated, $downloaded ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPageHeader ipsClearfix ipsSpacer_bottom\">\n\t<h1 class=\"ipsType_pageTitle\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'downloads', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n<\/div>\n\nCONTENT;\n\nif ( !\\IPS\\downloads\\Category::theOnlyNode() ):\n$return .= <<<CONTENT\n\n\t<a href='#elDownloadsCategories_menu' data-ipsMenu id='elDownloadsCategories' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth ipsResponsive_hideDesktop ipsResponsive_block ipsSpacer_bottom'><span class='ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'downloads_category_select', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n&nbsp;&nbsp;<\/span> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'all', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryMenu( \\IPS\\downloads\\Category::roots() );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\downloads\\Category::theOnlyNode()->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth ipsResponsive_hideDesktop ipsResponsive_block ipsSpacer_bottom'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_all_files', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( !empty( $featured ) ):\n$return .= <<<CONTENT\n\n\t<div class='ipsBox ipsSpacer_bottom'>\n\t\t<h2 class='ipsType_sectionTitle ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'featured_downloads', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t<section id='elDownloadsFeatured'>\n\t\t\t<div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-fullSizeItems data-ipsCarousel-slideshow data-ipsCarousel-shadows='false'>\n\t\t\t\t<ul class='cDownloadsCarousel ipsClearfix' data-role=\"carouselItems\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $featured as $file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \"downloads\" )->featuredFile( $file );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowLeft'><\/span>\n\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowRight'><\/span>\n\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'><\/i><\/a>\n\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'><\/i><\/a>\n\t\t\t<\/div>\n\t\t<\/section>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\downloads\\Category::canOnAny('add') OR \\IPS\\downloads\\Category::theOnlyNode() ):\n$return .= <<<CONTENT\n\n<ul class=\"ipsToolList ipsToolList_horizontal ipsResponsive_hidePhone ipsClearfix ipsSpacer_bottom\">\n\nCONTENT;\n\nif ( \\IPS\\downloads\\Category::canOnAny('add') ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryButtons( \\IPS\\downloads\\Category::canOnAny('add') );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\downloads\\Category::theOnlyNode() ):\n$return .= <<<CONTENT\n\n\t<li><a class='ipsButton ipsButton_link ipsButton_medium ipsButton_fullWidth' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\downloads\\Category::theOnlyNode()->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_all_files', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->idm_show_newest  ):\n$return .= <<<CONTENT\n\n\t<div class='ipsBox'>\n\t\t<h2 class='ipsType_sectionTitle ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'browse_whats_new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t<div class='ipsPad_half'>\n\t\t\t\nCONTENT;\n\nif ( count( $new ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-showDots>\n\t\t\t\t\t<ul class='cDownloadsCarousel' data-role=\"carouselItems\">\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $new as $idx => $file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->indexBlock( $file );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowLeft'><\/span>\n\t\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowRight'><\/span>\n\t\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'><\/i><\/a>\n\t\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'><\/i><\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_reset ipsType_light ipsPad'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_new_files', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->idm_show_highest_rated  ):\n$return .= <<<CONTENT\n\n\t<div class='ipsBox ipsSpacer_top'>\n\t\t<h2 class='ipsType_sectionTitle ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'browse_highest_rated', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t<div class='ipsPad_half'>\n\t\t\t\nCONTENT;\n\nif ( count( $rated ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-showDots>\n\t\t\t\t\t<ul class='cDownloadsCarousel' data-role=\"carouselItems\">\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $rated as $idx => $file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->indexBlock( $file );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowLeft'><\/span>\n\t\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowRight'><\/span>\n\t\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'><\/i><\/a>\n\t\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'><\/i><\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_reset ipsType_light ipsPad'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_rated_files', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->idm_show_most_downloaded  ):\n$return .= <<<CONTENT\n\n\t<div class='ipsBox ipsSpacer_top'>\n\t\t<h2 class='ipsType_sectionTitle ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'browse_most_downloaded', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t<div class='ipsPad_half'>\n\t\t\t\nCONTENT;\n\nif ( count( $downloaded ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-showDots>\n\t\t\t\t\t<ul class='cDownloadsCarousel' data-role=\"carouselItems\">\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $downloaded as $idx => $file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->indexBlock( $file );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowLeft'><\/span>\n\t\t\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowRight'><\/span>\n\t\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'><\/i><\/a>\n\t\t\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'><\/i><\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_reset ipsType_light ipsPad'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_downloaded_files', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( \\IPS\\downloads\\Category::canOnAny('add') ):\n$return .= <<<CONTENT\n\n\t<ul class=\"ipsToolList ipsToolList_horizontal ipsResponsive_showPhone ipsResponsive_block ipsClearfix ipsSpacer_top\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoryButtons( \\IPS\\downloads\\Category::canOnAny('add') );\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction indexBlock( $file ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<li class='ipsAreaBackground_reset ipsType_blendLinks ipsClearfix cDownloadsCarouselItem ipsPad_half ipsCarousel_item'>\n\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$sprintf = array($file->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_this_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->thumbImage( $file->primary_screenshot_thumb, $file->name );\n$return .= <<<CONTENT\n\n    <\/a>\n\t\t<div class='cDownloadsCarouselItem_info ipsSpacer_top ipsSpacer_half'>\n\t\t\t<h3 class='ipsType_normal ipsType_reset ipsTruncate ipsTruncate_line'>\n\t\t\t\t\nCONTENT;\n\nif ( $file->unread() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsItemStatus ipsItemStatus_small' data-ipsTooltip title='\nCONTENT;\n\nif ( $file->unread() === -1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'updated', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class=\"fa fa-circle\"><\/i><\/span>&nbsp;\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $file->mapped('pinned') || $file->hidden() === -1 || $file->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->hidden() === -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n$return .= htmlspecialchars( $file->hiddenBlurb(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span>\n\t\t\t\t\t\nCONTENT;\n\nelseif ( $file->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pending_approval', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-warning'><\/i><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->mapped('pinned') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pinned', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-thumb-tack'><\/i><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$sprintf = array($file->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_this_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $file->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/h3>\n\t\t\t\n\t\t\t<p class='ipsType_medium ipsType_reset ipsType_blendLinks ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$htmlsprintf = array($file->author()->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_nodate', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nif ( $file->container()->bitoptions['reviews'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->rating( 'medium', $file->rating, \\IPS\\Settings::i()->reviews_rating_out_of );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<p class='ipsType_medium ipsType_reset'>\n\t\t\t\t\nCONTENT;\n\nif ( $file->isPaid() and in_array( 'purchases', explode( ',', \\IPS\\Settings::i()->idm_nexus_display ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span \nCONTENT;\n\nif ( !$file->purchaseCount() ):\n$return .= <<<CONTENT\nclass='ipsType_light'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n title='\nCONTENT;\n\n$pluralize = array( $file->purchaseCount() ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'x_purchases', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-shopping-cart'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $file->purchaseCount(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>&nbsp;&nbsp;\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( !$file->isPaid() or in_array( 'downloads', explode( ',', \\IPS\\Settings::i()->idm_nexus_display ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span \nCONTENT;\n\nif ( !$file->downloads ):\n$return .= <<<CONTENT\nclass='ipsType_light'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n title='\nCONTENT;\n\n$pluralize = array( $file->downloads ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'x_downloads', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-arrow-circle-down'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $file->downloads, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>&nbsp;&nbsp;\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t \n\t\t\t\t\nCONTENT;\n\nif ( $file->container()->bitoptions['comments'] ):\n$return .= <<<CONTENT\n<span \nCONTENT;\n\nif ( !$file->comments ):\n$return .= <<<CONTENT\nclass='ipsType_light'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n title='\nCONTENT;\n\n$pluralize = array( $file->comments ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'num_comments', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-comment'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $file->comments, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\t\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Application::appIsEnabled( 'nexus' ) and \\IPS\\Settings::i()->idm_nexus_on ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cFilePrice ipsType_medium\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->isPaid() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $price = $file->price() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t{$price}\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'file_free', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n<\/li>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction indexSidebar( $canSubmitFiles, $currentCategory=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"browse\", \\IPS\\Request::i()->app )->categoriesSidebar( $currentCategory );\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction noFiles( $category ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsType_center ipsPad'>\n\t<p class='ipsType_large'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_files_in_cat', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\n\t\nCONTENT;\n\nif ( $category->can('add') ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $category->club() ):\n$return .= <<<CONTENT\n\n\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=downloads&module=downloads&controller=submit&do=submit&category={$category->id}\", null, \"downloads_submit\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_medium'>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=downloads&module=downloads&controller=submit&_new=1&category={$category->id}\", null, \"downloads_submit\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_medium' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit_first_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-size='narrow'>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submit_first_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction rows( $table, $headers, $files ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( count( $files ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $files as $file ):\n$return .= <<<CONTENT\n\n\t\t<li class='ipsDataItem \nCONTENT;\n\nif ( $file->unread() ):\n$return .= <<<CONTENT\nipsDataItem_unread\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( method_exists( $file, 'tableClass' ) && $file->tableClass() ):\n$return .= <<<CONTENT\nipsDataItem_\nCONTENT;\n$return .= htmlspecialchars( $file->tableClass(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $file->hidden() ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t<div class='ipsDataItem_generic ipsDataItem_size3 ipsPos_top'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->thumbImage( $file->primary_screenshot_thumb, $file->name, 'medium', '', 'view_this', $file->url() );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Application::appIsEnabled( 'nexus' ) and \\IPS\\Settings::i()->idm_nexus_on ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class='ipsType_large ipsType_center ipsType_reset ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t\t\t<span class='cFilePrice'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->isPaid() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $price = $file->price() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t{$price}\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'file_free', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t<h4 class='ipsDataItem_title ipsType_sectionHead ipsContained_container'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->unread() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class='ipsItemStatus ipsItemStatus_small' data-ipsTooltip title='\nCONTENT;\n\nif ( $file->unread() === -1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'new', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'updated', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class=\"fa fa-circle\"><\/i><\/span>&nbsp;<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->mapped('pinned') || $file->mapped('featured') || $file->hidden() === -1 || $file->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->hidden() === -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n$return .= htmlspecialchars( $file->hiddenBlurb(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $file->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pending_approval', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-warning'><\/i><\/span><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->mapped('pinned') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pinned', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-thumb-tack'><\/i><\/span><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->mapped('featured') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'featured', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-star'><\/i><\/span><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->prefix() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->prefix( $file->prefix( TRUE ), $file->prefix() );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\n\t\t\t\t\t<span class='ipsType_break ipsContained'><a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$sprintf = array($file->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_this_file', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $file->canEdit() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'click_hold_edit', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $file->canEdit() ):\n$return .= <<<CONTENT\ndata-role=\"editableTitle\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $file->name, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/span>\n\t\t\t\t<\/h4>\n\t\t\t\t<p class='ipsType_reset ipsType_light ipsType_blendLinks'>\n\t\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($file->author()->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_nodate', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->app != 'downloads' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'in', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <a href=\"\nCONTENT;\n$return .= htmlspecialchars( $file->container()->url(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $file->container()->_title, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\t\t\t\t<div class='ipsType_medium ipsType_richText ipsType_break ipsSpacer_top' data-ipsTruncate data-ipsTruncate-type=\"remove\" data-ipsTruncate-size=\"2 lines\">\n\t\t\t\t\t{$file->truncated()}\n\t\t\t\t<\/div>\n\n\t\t\t\t<p class='ipsType_normal'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $file->isPaid() and in_array( 'purchases', explode( ',', \\IPS\\Settings::i()->idm_nexus_display ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span \nCONTENT;\n\nif ( !$file->purchaseCount() ):\n$return .= <<<CONTENT\nclass='ipsType_light'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class='fa fa-shopping-cart'><\/i> \nCONTENT;\n\n$pluralize = array( $file->purchaseCount() ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'x_purchases', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>&nbsp;&nbsp;\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( !$file->isPaid() or in_array( 'downloads', explode( ',', \\IPS\\Settings::i()->idm_nexus_display ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span \nCONTENT;\n\nif ( !$file->downloads ):\n$return .= <<<CONTENT\nclass='ipsType_light'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class='fa fa-arrow-circle-down'><\/i> \nCONTENT;\n\n$pluralize = array( $file->downloads ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'num_downloads', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/p>\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $file->tags() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tags( $file->tags(), TRUE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<div class='ipsDataItem_generic ipsDataItem_size8'>\n\t\t\t\t\nCONTENT;\n\nif ( $file->container()->bitoptions['reviews'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->rating( 'large', $file->averageReviewRating(), \\IPS\\Settings::i()->reviews_rating_out_of, $file->memberReviewRating() );\n$return .= <<<CONTENT\n&nbsp;&nbsp; <span class='ipsType_normal ipsType_light'>(\nCONTENT;\n\n$pluralize = array( $file->reviews ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'num_reviews', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n)<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $file->container()->bitoptions['comments'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class='ipsType_normal'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->comments ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url()->setQueryString( 'tab', 'comments' )->setFragment('replies'), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<i class='fa fa-comment'><\/i> \nCONTENT;\n\n$pluralize = array( $file->comments ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'num_comments', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $file->comments ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_medium'><strong>\nCONTENT;\n\nif ( $file->updated == $file->submitted ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'submitted', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $file->submitted instanceof \\IPS\\DateTime ) ? $file->submitted : \\IPS\\DateTime::ts( $file->submitted );$return .= $val->html(FALSE);\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'updated', \\IPS\\HTMLENTITIES, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $file->updated instanceof \\IPS\\DateTime ) ? $file->updated : \\IPS\\DateTime::ts( $file->updated );$return .= $val->html(FALSE);\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/strong><\/p>\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( method_exists( $table, 'canModerate' ) AND $table->canModerate() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsDataItem_modCheck'>\n\t\t\t\t\t<span class='ipsCustomInput'>\n\t\t\t\t\t\t<input type='checkbox' data-role='moderation' name=\"moderate[\nCONTENT;\n$return .= htmlspecialchars( $file->id, ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" data-actions=\"\nCONTENT;\n\n$return .= htmlspecialchars( implode( ' ', $table->multimodActions( $file ) ), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-state='\nCONTENT;\n\nif ( $file->tableStates() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $file->tableStates(), ENT_QUOTES | \\IPS\\HTMLENTITIES, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<span><\/span>\n\t\t\t\t\t<\/span>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
